<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EonGenesis.id - Kursus Sempoa dengan Teknologi AR</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&family=Playfair+Display:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --nude: #E8D6C0;
            --brown: #8B5A2B;
            --dark-brown: #4A2C2A;
            --light-brown: #C4A586;
            --earth: #A86F4C;
            --cream: #F8F4E9;
            --premium: #FFD700;
            --beige: #F5F5DC;
            --light-beige: #FAF8F1;
            --medium-beige: #E4D5C7;
        }
        
        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--cream);
            color: var(--dark-brown);
        }
        
        .brand-font {
            font-family: 'Playfair Display', serif;
        }
        
        .navbar {
            background-color: var(--dark-brown);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .navbar-brand {
            font-weight: 700;
            color: var(--nude) !important;
            display: flex;
            align-items: center;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
        }
        
        .logo {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--nude) 0%, var(--light-brown) 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid var(--nude);
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        .logo-text {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            color: var(--dark-brown);
            font-size: 18px;
        }
        
        .logo-alternative {
            width: 40px;
            height: 40px;
            margin-right: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: var(--nude);
        }
        
        .hero-section {
            background: linear-gradient(135deg, var(--dark-brown) 0%, var(--earth) 100%);
            color: var(--cream);
            padding: 100px 0;
            margin-bottom: 50px;
        }
        
        .card {
            border-radius: 10px;
            box-shadow: 0 0.15rem 1.75rem 0 rgba(90, 70, 50, 0.15);
            transition: transform 0.3s;
            margin-bottom: 20px;
            border: none;
            background-color: var(--cream);
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .btn-primary {
            background-color: var(--brown);
            border-color: var(--brown);
        }
        
        .btn-primary:hover {
            background-color: var(--dark-brown);
            border-color: var(--dark-brown);
        }
        
        .btn-outline-primary {
            color: var(--brown);
            border-color: var(--brown);
        }
        
        .btn-outline-primary:hover {
            background-color: var(--brown);
            color: white;
        }
        
        .section-title {
            position: relative;
            padding-bottom: 15px;
            margin-bottom: 30px;
            color: var(--dark-brown);
        }
        
        .section-title:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 80px;
            height: 3px;
            background-color: var(--brown);
        }
        
        .ar-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: var(--earth);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
        }
        
        .feature-icon {
            font-size: 2.5rem;
            color: var(--brown);
            margin-bottom: 15px;
        }
        
        footer {
            background-color: var(--dark-brown);
            color: var(--nude);
            padding: 40px 0;
        }
        
        .dashboard-card {
            height: 100%;
        }
        
        .nav-pills .nav-link.active {
            background-color: var(--brown);
        }
        
        .nav-pills .nav-link {
            color: var(--dark-brown);
        }
        
        .progress-bar {
            background-color: var(--brown);
        }
        
        .trial-counter {
            background-color: var(--light-brown);
            color: var(--dark-brown);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .trial-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--dark-brown);
        }
        
        .product-card {
            border-left: 4px solid var(--brown);
        }
        
        .logo-upload-section {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0.15rem 1.75rem 0 rgba(90, 70, 50, 0.15);
            margin-bottom: 30px;
        }
        
        .logo-preview {
            width: 150px;
            height: 150px;
            border: 2px dashed var(--brown);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            overflow: hidden;
        }
        
        .logo-options {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        .logo-option {
            width: 80px;
            height: 80px;
            border: 2px solid var(--light-brown);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .logo-option:hover {
            transform: scale(1.05);
            border-color: var(--brown);
        }
        
        .price-original {
            text-decoration: line-through;
            color: #999;
            font-size: 0.9rem;
        }
        
        .price-discount {
            color: #e74a3b;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .discount-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: #e74a3b;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .login-bar {
            background-color: var(--light-brown);
            padding: 8px 0;
            text-align: right;
        }
        
        .login-form {
            display: inline-flex;
            gap: 10px;
            align-items: center;
        }
        
        .login-input {
            padding: 5px 10px;
            border: 1px solid var(--brown);
            border-radius: 4px;
            font-size: 14px;
        }
        
        .ar-container {
            width: 100%;
            height: 400px;
            border: 2px solid var(--brown);
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
            background-color: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        
        .ar-placeholder {
            font-size: 3rem;
            color: var(--brown);
            margin-bottom: 15px;
        }
        
        .trial-modal .modal-content {
            background-color: var(--cream);
            border-radius: 15px;
        }
        
        .trial-modal .modal-header {
            border-bottom: 2px solid var(--brown);
            background-color: var(--dark-brown);
            color: var(--nude);
            border-radius: 15px 15px 0 0;
        }
        
        .trial-modal .btn-close {
            color: var(--nude);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--dark-brown);
        }
        
        .user-avatar {
            width: 30px;
            height: 30px;
            background-color: var(--brown);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .login-notice {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        
        .login-notice i {
            margin-right: 10px;
            font-size: 1.5rem;
        }
        
        .premium-badge {
            background-color: var(--premium);
            color: #856404;
            padding: 3px 8px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: bold;
            margin-left: 8px;
        }
        
        .payment-modal .modal-content {
            border-radius: 15px;
        }
        
        .payment-option {
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .payment-option:hover {
            border-color: var(--brown);
            background-color: #f9f9f9;
        }
        
        .payment-option.selected {
            border-color: var(--brown);
            background-color: rgba(139, 90, 43, 0.1);
        }
        
        .access-badge {
            background-color: var(--brown);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .paid-badge {
            background-color: #28a745;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .locked-content {
            filter: blur(5px);
            pointer-events: none;
            position: relative;
        }
        
        .locked-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
        }
        
        .locked-icon {
            font-size: 2rem;
            color: white;
        }
        
        .qr-code {
            width: 200px;
            height: 200px;
            margin: 0 auto;
            display: block;
        }
        
        .admin-reset {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .affiliate-section {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
        }
        
        .zoom-class {
            background-color: #e8f4fd;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
        }
        
        .material-access {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 10px;
        }
        
        .material-list {
            list-style-type: none;
            padding: 0;
        }
        
        .material-list li {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .material-list li:last-child {
            border-bottom: none;
        }
        
        .trial-promo {
            background-color: #e8f4fd;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
        }
        
        .material-item {
            margin-bottom: 15px;
            padding: 15px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .material-locked {
            position: relative;
        }
        
        .material-locked::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            color: white;
            font-weight: bold;
        }
        
        .material-locked::before {
            content: '🔒 Kunci - Belum Dibeli';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2;
            color: white;
            font-weight: bold;
            text-align: center;
        }
        
        .admin-section {
            display: none;
        }
        
        .user-section {
            display: block;
        }
        
        .admin-menu {
            background-color: var(--dark-brown);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .admin-menu-item {
            padding: 10px 15px;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        
        .admin-menu-item:hover, .admin-menu-item.active {
            background-color: var(--brown);
        }
        
        .upload-area {
            border: 2px dashed var(--brown);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
        }
        
        .upload-area:hover {
            background-color: #f9f9f9;
        }
        
        .material-preview {
            max-width: 100%;
            max-height: 200px;
            margin-top: 10px;
        }
        
        .affiliate-badge {
            background-color: #17a2b8;
            color: white;
            padding: 3px 8px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: bold;
        }
        
        .voucher-section {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }
        
        .flyer-container {
            background: linear-gradient(135deg, var(--dark-brown) 0%, var(--earth) 100%);
            border-radius: 15px;
            padding: 20px;
            color: white;
            text-align: center;
            margin: 20px 0;
            position: relative;
        }
        
        .flyer-logo {
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-weight: bold;
            font-size: 24px;
            color: var(--dark-brown);
        }
        
        .flyer-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .flyer-code {
            background-color: white;
            color: var(--dark-brown);
            padding: 10px 20px;
            border-radius: 30px;
            font-weight: bold;
            font-size: 18px;
            display: inline-block;
            margin: 15px 0;
        }
        
        .flyer-description {
            margin-bottom: 15px;
            font-size: 14px;
        }
        
        .admin-content {
            display: none;
        }
        
        .admin-content.active {
            display: block;
        }
        
        .material-input-group {
            margin-bottom: 15px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        
        .payment-proof {
            max-width: 100%;
            max-height: 300px;
            border-radius: 8px;
            margin-top: 10px;
        }
        
        .sales-chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 30px;
        }
        
        .test-container {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .test-question {
            margin-bottom: 15px;
        }
        
        .test-options {
            margin-left: 20px;
        }
        
        .test-result {
            text-align: center;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .score-display {
            font-size: 2rem;
            font-weight: bold;
            color: var(--brown);
        }
        
        .flyer-image {
            width: 100%;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .flyer-modal .modal-dialog {
            max-width: 500px;
        }
        
        .flyer-modal .modal-body {
            text-align: center;
        }
        
        .instagram-story {
            width: 100%;
            height: 600px;
            background: linear-gradient(135deg, var(--beige) 0%, var(--medium-beige) 100%);
            border-radius: 20px;
            position: relative;
            overflow: hidden;
            margin: 20px auto;
        }
        
        .story-content {
            padding: 40px;
            color: var(--dark-brown);
            text-align: center;
            position: relative;
            z-index: 2;
        }
        
        .story-logo {
            width: 100px;
            height: 100px;
            background: var(--dark-brown);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-weight: bold;
            font-size: 30px;
            color: var(--nude);
        }
        
        .story-kids-image {
            width: 100%;
            max-height: 250px;
            object-fit: contain;
            margin: 15px 0;
            border-radius: 10px;
        }
        
        .story-affiliate-code {
            background-color: var(--dark-brown);
            color: var(--nude);
            padding: 10px 20px;
            border-radius: 30px;
            font-weight: bold;
            font-size: 20px;
            display: inline-block;
            margin: 15px 0;
        }
        
        .story-handle {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            text-align: center;
            font-weight: bold;
            font-size: 18px;
            color: var(--dark-brown);
        }
        
        .invoice-container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .invoice-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .invoice-details {
            margin-bottom: 20px;
        }
        
        .invoice-table {
            width: 100%;
            margin-bottom: 20px;
        }
        
        .invoice-table th, .invoice-table td {
            padding: 10px;
            border-bottom: 1px solid #ddd;
        }
        
        .invoice-total {
            text-align: right;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .beige-bg {
            background-color: var(--beige);
        }
        
        .light-beige-bg {
            background-color: var(--light-beige);
        }
        
        .medium-beige-bg {
            background-color: var(--medium-beige);
        }
        
        .beige-border {
            border-color: var(--medium-beige);
        }
        
        .beige-text {
            color: var(--dark-brown);
        }
        
        .file-format-warning {
            font-size: 0.8rem;
            color: #dc3545;
            margin-top: 5px;
        }
        
        @media (max-width: 768px) {
            .hero-section {
                padding: 60px 0;
            }
            
            .logo-options {
                flex-wrap: wrap;
            }
            
            .login-form {
                flex-direction: column;
                gap: 5px;
            }
            
            .login-bar {
                text-align: center;
            }
            
            .qr-code {
                width: 150px;
                height: 150px;
            }
            
            .instagram-story {
                height: 500px;
            }
            
            .story-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Login Bar -->
    <div class="login-bar">
        <div class="container">
            <div id="loginFormContainer">
                <form class="login-form" id="loginForm">
                    <input type="text" class="login-input" id="loginUsername" placeholder="Username" required>
                    <input type="password" class="login-input" id="loginPassword" placeholder="Password" required>
                    <button type="submit" class="btn btn-sm btn-primary">Login</button>
                    <button type="button" class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#registerModal">Daftar</button>
                </form>
            </div>
            <div id="userInfoContainer" class="user-info" style="display: none;">
                <div class="user-avatar" id="userAvatar"></div>
                <span id="userName"></span>
                <span id="userRole" class="premium-badge" style="display: none;">Admin</span>
                <span id="userStatus" class="premium-badge" style="display: none;">Premium</span>
                <span id="userAffiliate" class="affiliate-badge" style="display: none;">Affiliate</span>
                <button class="btn btn-sm btn-outline-primary ms-2" id="logoutBtn">Logout</button>
            </div>
        </div>
    </div>

    <!-- Modal Pendaftaran -->
    <div class="modal fade" id="registerModal" tabindex="-1" aria-labelledby="registerModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="registerModalLabel">Daftar Akun Baru</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="registerForm">
                        <div class="mb-3">
                            <label for="username" class="form-label">Username</label>
                            <input type="text" class="form-control" id="username" required>
                            <div class="form-text text-danger" id="usernameError" style="display: none;">Username sudah terdaftar</div>
                        </div>
                        <div class="mb-3">
                            <label for="password" class="form-label">Password</label>
                            <input type="password" class="form-control" id="password" required>
                        </div>
                        <div class="mb-3">
                            <label for="whatsapp" class="form-label">Nomor WhatsApp (contoh: 0812345678901)</label>
                            <input type="tel" class="form-control" id="whatsapp" required maxlength="13" pattern="08[0-9]{9,11}">
                            <div class="form-text text-danger" id="whatsappError" style="display: none;">Nomor WhatsApp sudah terdaftar</div>
                            <div class="form-text">Pastikan nomor WhatsApp aktif dan benar (13 digit, format: 08xxxxxxxxxx)</div>
                        </div>
                        <div class="mb-3">
                            <label for="affiliateCode" class="form-label">Kode Affiliate (opsional)</label>
                            <input type="text" class="form-control" id="affiliateCode">
                            <div class="form-text text-danger" id="affiliateError" style="display: none;">Kode affiliate tidak valid</div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-primary" id="submitRegister">Daftar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Free Trial -->
    <div class="modal fade trial-modal" id="trialModal" tabindex="-1" aria-labelledby="trialModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="trialModalLabel">Akses Free Trial</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="trialLoginNotice" class="login-notice">
                        <i class="fas fa-exclamation-circle"></i>
                        <div>Harap anda Login terlebih dahulu untuk mengakses Free Trial</div>
                    </div>
                    
                    <div id="trialLimitNotice" class="login-notice" style="display: none; background-color: #f8d7da; color: #721c24; border-color: #f5c6cb;">
                        <i class="fas fa-times-circle"></i>
                        <div>Anda telah mencapai batas maksimal Free Trial (2x per akun)</div>
                    </div>
                    
                    <div id="trialContent" style="display: none;">
                        <div class="text-center mb-4">
                            <i class="fas fa-vr-cardboard fa-4x mb-3" style="color: var(--brown);"></i>
                            <h4>Free Trial AR Sempoa</h4>
                            <p>Klik tombol di bawah untuk mengakses free trial kami</p>
                            <p class="text-muted">Sisa percobaan: <span id="trialCount">2</span>/2</p>
                        </div>
                        <div class="d-grid gap-2">
                            <button class="btn btn-primary btn-lg" id="useTrial">
                                <i class="fas fa-external-link-alt me-2"></i> Gunakan Free Trial
                            </button>
                        </div>
                        
                        <!-- Ajakan Beli Setelah Trial Habis -->
                        <div id="trialPromo" class="trial-promo" style="display: none;">
                            <h5>Free Trial Anda telah habis!</h5>
                            <p>Nikmati akses penuh ke teknologi AR Sempoa dengan membeli paket akses lengkap.</p>
                            <button class="btn btn-success mt-2" id="buyAfterTrial" data-product="Akses Link AR" data-price="30000">
                                <i class="fas fa-shopping-cart me-2"></i> Beli Akses AR - Rp 30.000
                            </button>
                        </div>
                        
                        <div class="mt-4">
                            <h5>Jika mengalami masalah:</h5>
                            <ol>
                                <li>Pastikan koneksi internet Anda stable</li>
                                <li>Coba buka link di browser yang berbeda</li>
                                <li>Hubungi kami jika masalah tetap berlanjut</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Pembayaran -->
    <div class="modal fade payment-modal" id="paymentModal" tabindex="-1" aria-labelledby="paymentModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="paymentModalLabel">Pembayaran</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Detail Pesanan</h6>
                            <div class="card">
                                <div class="card-body">
                                    <h6 id="paymentProductName">Nama Produk</h6>
                                    <p class="mb-1">Harga: <span id="paymentProductPrice">Rp 0</span></p>
                                    <p class="mb-0" id="voucherApplied" style="display: none;">Diskon: <span class="text-success">-10%</span></p>
                                    <p class="mb-0">Status: <span class="text-success">Belum dibayar</span></p>
                                </div>
                            </div>
                            
                            <!-- Section Voucher -->
                            <div class="voucher-section">
                                <h6>Gunakan Voucher</h6>
                                <div class="input-group mb-2">
                                    <input type="text" class="form-control" id="voucherCode" placeholder="Masukkan kode voucher">
                                    <button class="btn btn-outline-secondary" type="button" id="applyVoucher">Terapkan</button>
                                </div>
                                <div class="form-text" id="voucherMessage"></div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h6>Metode Pembayaran</h6>
                            <div class="payment-option selected" data-method="transfer">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="paymentMethod" id="transferMethod" checked>
                                    <label class="form-check-label" for="transferMethod">
                                        Transfer Bank
                                    </label>
                                </div>
                                <div class="mt-2" id="bankTransferDetails">
                                    <p class="mb-1"><strong>BCA: 1750999073 (Gabriella)</strong></p>
                                    <p class="mb-0 text-muted">Harap transfer tepat sampai 3 digit terakhir</p>
                                </div>
                            </div>
                            <div class="payment-option" data-method="qris">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="paymentMethod" id="qrisMethod">
                                    <label class="form-check-label" for="qrisMethod">
                                        QRIS (All Payment)
                                    </label>
                                </div>
                                <div class="mt-2 text-center" id="qrisCode" style="display: none;">
                                    <!-- QRIS yang dapat digunakan untuk pembayaran real -->
                                    <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=00020101021126680014ID.CO.QRIS.WWW01189360091403105779980203UKE5204581253033605802ID5914EONGENESIS.ID6007JAKARTA61051253062070703A016304C0D4" alt="QR Code QRIS" class="qr-code">
                                    <p class="mt-2">Scan QR code di atas untuk pembayaran via QRIS</p>
                                    <p class="text-muted">Dana akan diteruskan ke BCA: 1750999073 (Gabriella)</p>
                                    <p class="text-muted">Kode Merchant: EONGENESIS.ID</p>
                                </div>
                            </div>
                            
                            <div class="mt-3">
                                <label for="proofPayment" class="form-label">Upload Bukti Pembayaran (Hanya JPG)</label>
                                <input type="file" class="form-control" id="proofPayment" accept=".jpg,.jpeg" required>
                                <div class="file-format-warning">Hanya file JPG yang diperbolehkan</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-primary" id="confirmPayment">Konfirmasi Pembayaran</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Lihat Bukti Pembayaran -->
    <div class="modal fade" id="proofModal" tabindex="-1" aria-labelledby="proofModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="proofModalLabel">Bukti Pembayaran</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">
                    <img id="proofImage" src="" alt="Bukti Pembayaran" class="payment-proof">
                    <div class="mt-3" id="proofDetails"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Flyer Instagram Story -->
    <div class="modal fade flyer-modal" id="flyerModal" tabindex="-1" aria-labelledby="flyerModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="flyerModalLabel">Flyer Instagram Story</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="instagram-story" id="instagramStory">
                        <div class="story-content">
                            <div class="story-logo">EG</div>
                            <h3>EonGenesis.id</h3>
                            <p>Kursus Sempoa Modern dengan Teknologi AR</p>
                            <img src="https://images.unsplash.com/photo-1585432959449-b1c9c8cc49ac?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" alt="Anak-anak belajar sempoa AR" class="story-kids-image">
                            <div class="story-affiliate-code" id="storyAffiliateCode">KODE-AFFILIATE</div>
                            <p>Gunakan kode di atas untuk mendapatkan diskon 10%</p>
                            <div class="story-handle">@eongenesis.id</div>
                        </div>
                    </div>
                    <div class="d-grid gap-2">
                        <button class="btn btn-primary" id="downloadStory">
                            <i class="fas fa-download me-2"></i> Download Story
                        </button>
                        <button class="btn btn-outline-primary" id="shareStory">
                            <i class="fab fa-instagram me-2"></i> Bagikan ke Instagram Story
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Test (Pre-test/Post-test) -->
    <div class="modal fade" id="testModal" tabindex="-1" aria-labelledby="testModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="testModalLabel">Test</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="testContent">
                        <!-- Konten test akan dimuat di sini -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Invoice -->
    <div class="modal fade" id="invoiceModal" tabindex="-1" aria-labelledby="invoiceModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="invoiceModalLabel">Invoice Pembayaran</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="invoice-container" id="invoiceContent">
                        <!-- Konten invoice akan dimuat di sini -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                    <button type="button" class="btn btn-primary" id="printInvoice">Print Invoice</button>
                    <button type="button" class="btn btn-success" id="downloadInvoice">
                        <i class="fas fa-download me-2"></i> Download PDF
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Reset Button (Hanya terlihat untuk admin) -->
    <div class="admin-reset" id="adminResetButton" style="display: none;">
        <button class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#adminModal">
            <i class="fas fa-trash"></i> Reset Data
        </button>
    </div>

    <!-- Modal Admin -->
    <div class="modal fade" id="adminModal" tabindex="-1" aria-labelledby="adminModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="adminModalLabel">Admin Panel</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="adminPassword" class="form-label">Password Admin</label>
                        <input type="password" class="form-control" id="adminPassword">
                    </div>
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle"></i> PERINGATAN: Tindakan ini akan menghapus semua data pengguna yang terdaftar. Tindakan tidak dapat dibatalkan.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-danger" id="confirmReset">Reset Data</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
        <div class="container">
            <a class="navbar-brand brand-font" href="#">
                <!-- Opsi 1: Logo dengan CSS -->
                <div class="logo-container">
                    <div class="logo">
                        <span class="logo-text">E</span>
                    </div>
                </div>
                EonGenesis.id
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" data-bs-target="home">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-bs-target="profile">Profil</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-bs-target="products">Produk</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-bs-target="catalog">Katalog</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-bs-target="affiliate">Affiliate</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://wa.me/62895342517290" target="_blank">
                            <i class="fab fa-whatsapp me-1"></i> WhatsApp
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- User Section -->
    <div class="user-section">
        <!-- Main Content Sections -->
        <div class="container my-5">
            <!-- Home Section -->
            <section id="home-section" class="content-section">
                <!-- Hero Section -->
                <div class="hero-section rounded">
                    <div class="container">
                        <div class="row align-items-center">
                            <div class="col-lg-6">
                                <h1 class="display-4 fw-bold brand-font">Kursus Sempoa Modern dengan Teknologi AR</h1>
                                <p class="lead">Tingkatkan kemampuan berhitung dengan metode sempoa yang dipadukan dengan teknologi Augmented Reality untuk pengalaman belajar yang interaktif.</p>
                                <button class="btn btn-light btn-lg mt-3" data-bs-toggle="modal" data-bs-target="#trialModal">Coba Free Trial <i class="fas fa-arrow-right ms-2"></i></button>
                            </div>
                            <div class="col-lg-6 d-none d-lg-block">
                                <img src="https://images.unsplash.com/photo-1585432959449-b1c9c8cc49ac?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" class="img-fluid rounded shadow" alt="Sempoa AR">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Features Section -->
                <div class="py-5">
                    <div class="container">
                        <h2 class="section-title text-center">Mengapa Memilih EonGenesis.id?</h2>
                        <div class="row">
                            <div class="col-md-4 text-center mb-4">
                                <div class="feature-icon">
                                    <i class="fas fa-vr-cardboard"></i>
                                </div>
                                <h4>Teknologi AR</h4>
                                <p>Belajar sempoa dengan Augmented Reality untuk pengalaman interaktif yang menyenangkan.</p>
                            </div>
                            <div class="col-md-4 text-center mb-4">
                                <div class="feature-icon">
                                    <i class="fas fa-graduation-cap"></i>
                                </div>
                                <h4>Instruktur Berpengalaman</h4>
                                <p>Diajar oleh instruktur profesional yang telah bersertifikat dan berpengalaman dalam mengajar sempoa.</p>
                            </div>
                            <div class="col-md-4 text-center mb-4">
                                <div class="feature-icon">
                                    <i class="fas fa-certificate"></i>
                                </div>
                                <h4>Sertifikat Resmi</h4>
                                <p>Dapatkan sertifikat resmi setelah menyelesaikan kursus yang dapat meningkatkan nilai akademis.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Zoom Class Info -->
                <div class="zoom-class mt-5">
                    <h3 class="text-center"><i class="fas fa-video me-2"></i>Kelas Zoom Gratis</h3>
                    <p class="text-center">Setiap Hari Jumat pukul 18.30 WIB</p>
                    <div class="text-center mt-3">
                        <p>Bergabunglah dengan kelas Zoom gratis kami untuk belajar sempoa bersama instruktur profesional.</p>
                        <a href="#" class="btn btn-primary" id="zoomLink">Bergabung Kelas Zoom</a>
                    </div>
                </div>
            </section>

            <!-- Profile Section -->
            <section id="profile-section" class="content-section" style="display: none;">
                <h2 class="section-title">Profil Pengguna</h2>
                <div class="row">
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body text-center">
                                <div class="user-avatar mx-auto mb-3" style="width: 80px; height: 80px; font-size: 2rem;" id="profileAvatar"></div>
                                <h5 id="profileName">Nama Pengguna</h5>
                                <p id="profileWhatsapp">WhatsApp: -</p>
                                <div id="profileStatusBadge" class="premium-badge mb-3" style="display: none;">Premium</div>
                                <div id="profileAffiliateBadge" class="affiliate-badge mb-3" style="display: none;">Affiliate</div>
                            </div>
                        </div>
                        
                        <!-- Info Affiliate -->
                        <div class="card mt-4" id="affiliateInfoCard" style="display: none;">
                            <div class="card-body">
                                <h5 class="card-title">Info Affiliate</h5>
                                <p class="card-text">Kode Affiliate Anda:</p>
                                <h4 class="text-center" id="affiliateCodeValue"></h4>
                                <p class="card-text">Salin kode di atas dan bagikan kepada teman Anda. Anda akan mendapatkan komisi 10% dari setiap pembelian yang menggunakan kode affiliate Anda.</p>
                                <button class="btn btn-sm btn-outline-primary w-100" id="copyAffiliateCode">Salin Kode</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-body">
                                <h5>Produk yang Dimiliki</h5>
                                <div id="userProducts" class="mt-3">
                                    <p class="text-muted">Anda belum membeli produk apapun.</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Riwayat Affiliate -->
                        <div class="card mt-4" id="affiliateHistoryCard" style="display: none;">
                            <div class="card-body">
                                <h5 class="card-title">Riwayat Affiliate</h5>
                                <div class="table-responsive">
                                    <table class="table table-striped">
                                        <thead>
                                            <tr>
                                                <th>Pengguna</th>
                                                <th>Tanggal</th>
                                                <th>Produk</th>
                                                <th>Komisi</th>
                                            </tr>
                                        </thead>
                                        <tbody id="affiliateHistory">
                                            <!-- Data affiliate akan dimuat di sini -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Products Section -->
            <section id="products-section" class="content-section" style="display: none;">
                <h2 class="section-title">Produk Kami</h2>
                
                <div class="row">
                    <!-- Produk 1: Beginner Sempoa -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card product-card">
                            <div class="discount-badge">DISKON 10%</div>
                            <div class="card-body">
                                <h5 class="card-title">Beginner Sempoa</h5>
                                <p class="card-text">Paket pemula untuk belajar dasar-dasar sempoa dengan metode yang mudah dipahami.</p>
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <div>
                                        <span class="price-original">Rp 150.000</span>
                                        <span class="price-discount">Rp 135.000</span>
                                    </div>
                                    <span class="access-badge" data-product="beginner">Materi Terkunci</span>
                                </div>
                                <button class="btn btn-primary w-100 buy-btn" data-product="Beginner Sempoa" data-price="135000" data-product-key="beginner">
                                    Beli Sekarang
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Produk 2: Intermediate Sempoa -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card product-card">
                            <div class="discount-badge">DISKON 10%</div>
                            <div class="card-body">
                                <h5 class="card-title">Intermediate Sempoa</h5>
                                <p class="card-text">Tingkat lanjutan untuk menguasai teknik sempoa yang lebih kompleks.</p>
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <div>
                                        <span class="price-original">Rp 200.000</span>
                                        <span class="price-discount">Rp 180.000</span>
                                    </div>
                                    <span class="access-badge" data-product="intermediate">Materi Terkunci</span>
                                </div>
                                <button class="btn btn-primary w-100 buy-btn" data-product="Intermediate Sempoa" data-price="180000" data-product-key="intermediate">
                                    Beli Sekarang
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Produk 3: Advanced Sempoa -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card product-card">
                            <div class="discount-badge">DISKON 10%</div>
                            <div class="card-body">
                                <h5 class="card-title">Advanced Sempoa</h5>
                                <p class="card-text">Tingkat mahir untuk menjadi ahli dalam penggunaan sempoa dan perhitungan kompleks.</p>
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <div>
                                        <span class="price-original">Rp 250.000</span>
                                        <span class="price-discount">Rp 225.000</span>
                                    </div>
                                    <span class="access-badge" data-product="advanced">Materi Terkunci</span>
                                </div>
                                <button class="btn btn-primary w-100 buy-btn" data-product="Advanced Sempoa" data-price="225000" data-product-key="advanced">
                                    Beli Sekarang
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Produk 4: Akses Link AR -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card product-card">
                            <div class="card-body">
                                <h5 class="card-title">Akses Link AR</h5>
                                <p class="card-text">Akses khusus ke teknologi Augmented Reality untuk pembelajaran sempoa interaktif.</p>
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <div>
                                        <span class="price-discount">Rp 30.000</span>
                                    </div>
                                    <span class="access-badge" data-product="ar">Materi Terkunci</span>
                                </div>
                                <button class="btn btn-primary w-100 buy-btn" data-product="Akses Link AR" data-price="30000" data-product-key="ar">
                                    Beli Sekarang
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Produk 5: Materi PDF -->
                    <div class="col-md-6 col-lg-4">
                        <div class="card product-card">
                            <div class="card-body">
                                <h5 class="card-title">Materi PDF</h5>
                                <p class="card-text">Materi pembelajaran dalam format PDF yang dapat dilihat dan dicetak.</p>
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <div>
                                        <span class="price-discount">Rp 50.000</span>
                                    </div>
                                    <span class="access-badge" data-product="pdf">Materi Terkunci</span>
                                </div>
                                <button class="btn btn-primary w-100 buy-btn" data-product="Materi PDF" data-price="50000" data-product-key="pdf">
                                    Beli Sekarang
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Catalog Section -->
            <section id="catalog-section" class="content-section" style="display: none;">
                <h2 class="section-title">Katalog Materi</h2>
                
                <div class="alert alert-info">
                    <i class="fas fa-info-circle me-2"></i> Hanya materi dari produk yang telah Anda beli yang dapat diakses.
                </div>
                
                <!-- Materi Beginner Sempoa -->
                <div class="material-item" id="material-beginner">
                    <h4>Materi Beginner Sempoa</h4>
                    <p>Materi pembelajaran untuk tingkat pemula yang mencakup dasar-dasar penggunaan sempoa.</p>
                    <div class="material-access">
                        <h6>Daftar Materi:</h6>
                        <ul class="material-list">
                            <li><i class="fas fa-file-pdf me-2"></i> Pengenalan Sempoa - Dasar</li>
                            <li><i class="fas fa-file-pdf me-2"></i> Penjumlahan Sederhana</li>
                            <li><i class="fas fa-file-pdf me-2"></i> Pengurangan Sederhana</li>
                            <li><i class="fas fa-video me-2"></i> Video Tutorial Level 1</li>
                        </ul>
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-success access-material-btn" data-product="beginner">Akses Materi</button>
                            <button class="btn btn-sm btn-outline-primary take-test-btn" data-test-type="pre" data-product="beginner">Pre-test</button>
                            <button class="btn btn-sm btn-outline-primary take-test-btn" data-test-type="post" data-product="beginner">Post-test</button>
                        </div>
                    </div>
                </div>
                
                <!-- Materi Intermediate Sempoa -->
                <div class="material-item material-locked" id="material-intermediate">
                    <h4>Materi Intermediate Sempoa</h4>
                    <p>Materi pembelajaran untuk tingkat menengah dengan teknik yang lebih kompleks.</p>
                </div>
                
                <!-- Materi Advanced Sempoa -->
                <div class="material-item material-locked" id="material-advanced">
                    <h4>Materi Advanced Sempoa</h4>
                    <p>Materi pembelajaran untuk tingkat mahir dengan teknik perhitungan kompleks.</p>
                </div>
                
                <!-- Materi AR -->
                <div class="material-item material-locked" id="material-ar">
                    <h4>Materi Augmented Reality</h4>
                    <p>Akses ke teknologi AR untuk pembelajaran sempoa yang interaktif dan menyenangkan.</p>
                    <div class="material-access" style="display: none;">
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-success access-link-btn" data-product="ar">Akses Link</button>
                        </div>
                    </div>
                </div>
                
                <!-- Materi PDF -->
                <div class="material-item material-locked" id="material-pdf">
                    <h4>Materi PDF</h4>
                    <p>Kumpulan materi PDF yang dapat dilihat dan dicetak.</p>
                </div>
            </section>

            <!-- Affiliate Section -->
            <section id="affiliate-section" class="content-section" style="display: none;">
                <h2 class="section-title">Program Affiliate</h2>
                
                <div class="alert alert-info">
                    <i class="fas fa-info-circle me-2"></i> Dapatkan komisi 10% dari setiap pembelian yang menggunakan kode affiliate Anda.
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">Kode Affiliate Anda</h5>
                                <div class="text-center py-4">
                                    <h2 id="userAffiliateCode" class="text-primary">-</h2>
                                    <button class="btn btn-outline-primary mt-2" id="copyAffiliateBtn">
                                        <i class="fas fa-copy me-2"></i> Salin Kode
                                    </button>
                                </div>
                                <div class="mt-3">
                                    <h6>Cara menggunakan:</h6>
                                    <ol>
                                        <li>Salin kode affiliate Anda</li>
                                        <li>Bagikan kepada calon pengguna</li>
                                        <li>Calon pengguna memasukkan kode saat mendaftar</li>
                                        <li>Anda mendapatkan komisi 10% dari setiap pembelian mereka</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">Statistik Affiliate</h5>
                                <div class="text-center py-3">
                                    <div class="row">
                                        <div class="col-6">
                                            <h3 id="affiliateCount">0</h3>
                                            <p>Pengguna Terdaftar</p>
                                        </div>
                                        <div class="col-6">
                                            <h3 id="affiliateEarnings">Rp 0</h3>
                                            <p>Total Komisi</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <h6 class="mt-4">Riwayat Komisi</h6>
                                <div class="table-responsive">
                                    <table class="table table-sm">
                                        <thead>
                                            <tr>
                                                <th>Pengguna</th>
                                                <th>Tanggal</th>
                                                <th>Komisi</th>
                                            </tr>
                                        </thead>
                                        <tbody id="affiliateStats">
                                            <!-- Data affiliate akan dimuat di sini -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Flyer Affiliate -->
                <div class="flyer-container">
                    <div class="flyer-logo">EG</div>
                    <div class="flyer-title">EonGenesis.id</div>
                    <div class="flyer-description">Kursus Sempoa Modern dengan Teknologi AR</div>
                    <div class="flyer-code" id="flyerAffiliateCode">KODE-AFFILIATE</div>
                    <div class="flyer-description">Dapatkan diskon 10% dengan kode di atas</div>
                    
                    <div class="d-flex justify-content-center mt-4 gap-2">
                        <button class="btn btn-light" id="shareWhatsApp">
                            <i class="fab fa-whatsapp me-2"></i> Share ke WhatsApp
                        </button>
                        <button class="btn btn-light" id="generateFlyer">
                            <i class="fas fa-image me-2"></i> Generate Flyer Instagram
                        </button>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- Admin Section -->
    <div class="admin-section">
        <div class="container my-5">
            <h2 class="section-title">Panel Admin</h2>
            
            <div class="admin-menu">
                <div class="d-flex flex-wrap gap-2">
                    <div class="admin-menu-item active" data-target="dashboard">Dashboard</div>
                    <div class="admin-menu-item" data-target="links">Kelola Link</div>
                    <div class="admin-menu-item" data-target="materials">Kelola Materi</div>
                    <div class="admin-menu-item" data-target="videos">Kelola Video</div>
                    <div class="admin-menu-item" data-target="users">Kelola Pengguna</div>
                    <div class="admin-menu-item" data-target="payments">Kelola Pembayaran</div>
                    <div class="admin-menu-item" data-target="tests">Kelola Test</div>
                </div>
            </div>
            
            <!-- Dashboard Admin -->
            <div id="admin-dashboard" class="admin-content active">
                <div class="row">
                    <div class="col-md-4">
                        <div class="card text-center">
                            <div class="card-body">
                                <h5 class="card-title">Jumlah Pengguna</h5>
                                <p class="card-text display-4" id="userCount">0</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card text-center">
                            <div class="card-body">
                                <h5 class="card-title">Total Penjualan</h5>
                                <p class="card-text display-4" id="totalSales">0</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card text-center">
                            <div class="card-body">
                                <h5 class="card-title">Pendapatan</h5>
                                <p class="card-text display-4" id="totalRevenue">Rp 0</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Grafik Penjualan -->
                <div class="card mt-4">
                    <div class="card-body">
                        <h5 class="card-title">Grafik Penjualan Bulanan</h5>
                        <div class="sales-chart-container">
                            <canvas id="salesChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Kelola Link -->
            <div id="admin-links" class="admin-content">
                <h3 class="mb-4">Kelola Link</h3>
                
                <div class="card">
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="zoomLink" class="form-label">Link Kelas Zoom</label>
                            <input type="url" class="form-control" id="zoomLinkInput" placeholder="https://zoom.us/j/...">
                            <div class="form-text">Link ini akan digunakan untuk kelas Zoom gratis setiap Jumat</div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="arLink" class="form-label">Link Augmented Reality</label>
                            <input type="url" class="form-control" id="arLinkInput" placeholder="https://eongenesis-id.github.io/EONGENESIS/">
                            <div class="form-text">Link ini akan digunakan untuk akses teknologi AR</div>
                        </div>
                        
                        <button class="btn btn-primary" id="saveLinks">Simpan Link</button>
                    </div>
                </div>
            </div>
            
            <!-- Kelola Materi -->
            <div id="admin-materials" class="admin-content">
                <h3 class="mb-4">Kelola Materi PDF</h3>
                
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Tambah Materi PDF</h5>
                        
                        <div id="pdfMaterialsContainer">
                            <!-- Input untuk 10 materi PDF -->
                        </div>
                        
                        <button class="btn btn-primary mt-3" id="savePdfMaterials">Simpan Materi PDF</button>
                    </div>
                </div>
            </div>
            
            <!-- Kelola Video -->
            <div id="admin-videos" class="admin-content">
                <h3 class="mb-4">Kelola Video Tutorial</h3>
                
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Tambah Video Tutorial</h5>
                        
                        <div id="videoMaterialsContainer">
                            <!-- Input untuk 10 video tutorial -->
                        </div>
                        
                        <button class="btn btn-primary mt-3" id="saveVideoMaterials">Simpan Video Tutorial</button>
                    </div>
                </div>
            </div>
            
            <!-- Kelola Pengguna -->
            <div id="admin-users" class="admin-content">
                <h3 class="mb-4">Kelola Pengguna</h3>
                
                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Username</th>
                                        <th>WhatsApp</th>
                                        <th>Produk</th>
                                        <th>Tanggal Daftar</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="usersList">
                                    <!-- Daftar pengguna akan dimuat di sini -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Kelola Pembayaran -->
            <div id="admin-payments" class="admin-content">
                <h3 class="mb-4">Kelola Pembayaran</h3>
                
                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>User</th>
                                        <th>Produk</th>
                                        <th>Harga</th>
                                        <th>Metode</th>
                                        <th>Status</th>
                                        <th>Tanggal</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="paymentsList">
                                    <!-- Daftar pembayaran akan dimuat di sini -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Kelola Test -->
            <div id="admin-tests" class="admin-content">
                <h3 class="mb-4">Kelola Test</h3>
                
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Kelola Soal Pre-test dan Post-test</h5>
                        
                        <ul class="nav nav-tabs" id="testTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="pretest-tab" data-bs-toggle="tab" data-bs-target="#pretest" type="button" role="tab">Pre-test</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="posttest-tab" data-bs-toggle="tab" data-bs-target="#posttest" type="button" role="tab">Post-test</button>
                            </li>
                        </ul>
                        
                        <div class="tab-content" id="testTabContent">
                            <div class="tab-pane fade show active" id="pretest" role="tabpanel">
                                <div id="pretestContainer" class="mt-3">
                                    <!-- Input untuk 10 soal pre-test -->
                                </div>
                            </div>
                            <div class="tab-pane fade" id="posttest" role="tabpanel">
                                <div id="posttestContainer" class="mt-3">
                                    <!-- Input untuk 10 soal post-test -->
                                </div>
                            </div>
                        </div>
                        
                        <button class="btn btn-primary mt-3" id="saveTests">Simpan Soal Test</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-4">
                    <h5 class="brand-font">EonGenesis.id</h5>
                    <p>Kursus Sempoa Modern dengan Teknologi Augmented Reality untuk pengalaman belajar yang interaktif dan menyenangkan.</p>
                </div>
                <div class="col-md-4 mb-4">
                    <h5>Kontak Kami</h5>
                    <p><i class="fab fa-whatsapp me-2"></i> +62 895-3425-17290</p>
                    <p><i class="fas fa-envelope me-2"></i> info@eongenesis.id</p>
                </div>
                <div class="col-md-4 mb-4">
                    <h5>Follow Kami</h5>
                    <div class="d-flex gap-3">
                        <a href="#" class="text-light"><i class="fab fa-instagram fa-2x"></i></a>
                        <a href="#" class="text-light"><i class="fab fa-facebook fa-2x"></i></a>
                        <a href="#" class="text-light"><i class="fab fa-youtube fa-2x"></i></a>
                    </div>
                </div>
            </div>
            <hr>
            <div class="text-center">
                <p>&copy; 2023 EonGenesis.id. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Inisialisasi data
            if (!localStorage.getItem('users')) {
                localStorage.setItem('users', JSON.stringify([
                    {
                        username: 'admin',
                        password: 'admin123',
                        whatsapp: '081234567890',
                        role: 'admin',
                        registeredAt: new Date().toISOString()
                    }
                ]));
            }
            
            if (!localStorage.getItem('payments')) {
                localStorage.setItem('payments', JSON.stringify([]));
            }
            
            if (!localStorage.getItem('trials')) {
                localStorage.setItem('trials', JSON.stringify([]));
            }
            
            if (!localStorage.getItem('affiliates')) {
                localStorage.setItem('affiliates', JSON.stringify([]));
            }
            
            if (!localStorage.getItem('vouchers')) {
                localStorage.setItem('vouchers', JSON.stringify([
                    { code: 'DISKON10', discount: 10, used: false }
                ]));
            }
            
            if (!localStorage.getItem('links')) {
                localStorage.setItem('links', JSON.stringify({
                    zoom: 'https://zoom.us/j/1234567890',
                    ar: 'https://eongenesis-id.github.io/EONGENESIS/'
                }));
            }
            
            if (!localStorage.getItem('materials')) {
                localStorage.setItem('materials', JSON.stringify({
                    pdf: [],
                    video: []
                }));
            }
            
            if (!localStorage.getItem('tests')) {
                localStorage.setItem('tests', JSON.stringify({
                    pretest: [],
                    posttest: []
                }));
            }
            
            // Variabel global
            let currentUser = null;
            let isAdmin = false;
            let appliedVoucher = null;
            let salesChart = null;
            
            // Fungsi untuk menampilkan notifikasi
            function showAlert(message, type = 'success') {
                const alertDiv = document.createElement('div');
                alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
                alertDiv.innerHTML = `
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                `;
                
                document.querySelector('.container').prepend(alertDiv);
                
                setTimeout(() => {
                    alertDiv.remove();
                }, 5000);
            }
            
            // Fungsi untuk menampilkan section berdasarkan target
            function showSection(target) {
                document.querySelectorAll('.content-section').forEach(section => {
                    section.style.display = 'none';
                });
                
                document.querySelector(`#${target}-section`).style.display = 'block';
                
                // Jika user login, update tampilan materi berdasarkan produk yang dimiliki
                if (currentUser && !isAdmin) {
                    updateMaterialAccess();
                    updateProductBadges();
                    updateUserProducts();
                    
                    // Jika section affiliate, update data affiliate
                    if (target === 'affiliate') {
                        updateAffiliateData();
                    }
                    
                    // Jika section profile, update data profile
                    if (target === 'profile') {
                        updateProfileData();
                    }
                }
                
                // Jika admin, load data admin
                if (isAdmin) {
                    loadAdminData();
                    
                    // Load form materials dan videos
                    if (target === 'materials') {
                        loadPdfMaterialsForm();
                    }
                    
                    if (target === 'videos') {
                        loadVideoMaterialsForm();
                    }
                    
                    if (target === 'tests') {
                        loadTestForms();
                    }
                    
                    // Jika dashboard, update grafik penjualan
                    if (target === 'dashboard') {
                        updateSalesChart();
                    }
                }
            }
            
            // Fungsi untuk load form PDF materials
            function loadPdfMaterialsForm() {
                const materials = JSON.parse(localStorage.getItem('materials'));
                const pdfMaterials = materials.pdf || [];
                const container = document.getElementById('pdfMaterialsContainer');
                
                container.innerHTML = '';
                
                for (let i = 0; i < 10; i++) {
                    const material = pdfMaterials[i] || { title: '', file: null };
                    
                    const materialHtml = `
                        <div class="material-input-group">
                            <h6>Materi PDF ${i + 1}</h6>
                            <div class="mb-2">
                                <label class="form-label">Judul Materi</label>
                                <input type="text" class="form-control pdf-title" data-index="${i}" value="${material.title}" placeholder="Judul materi PDF">
                            </div>
                            <div class="mb-2">
                                <label class="form-label">File PDF</label>
                                <input type="file" class="form-control pdf-file" data-index="${i}" accept=".pdf">
                                ${material.file ? `<div class="form-text">File saat ini: <a href="${material.file}" target="_blank">Lihat</a></div>` : ''}
                            </div>
                        </div>
                    `;
                    
                    container.innerHTML += materialHtml;
                }
            }
            
            // Fungsi untuk load form video materials
            function loadVideoMaterialsForm() {
                const materials = JSON.parse(localStorage.getItem('materials'));
                const videoMaterials = materials.video || [];
                const container = document.getElementById('videoMaterialsContainer');
                
                container.innerHTML = '';
                
                for (let i = 0; i < 10; i++) {
                    const material = videoMaterials[i] || { title: '', file: null };
                    
                    const materialHtml = `
                        <div class="material-input-group">
                            <h6>Video Tutorial ${i + 1}</h6>
                            <div class="mb-2">
                                <label class="form-label">Judul Video</label>
                                <input type="text" class="form-control video-title" data-index="${i}" value="${material.title}" placeholder="Judul video tutorial">
                            </div>
                            <div class="mb-2">
                                <label class="form-label">File Video</label>
                                <input type="file" class="form-control video-file" data-index="${i}" accept=".mp4,.mov,.avi">
                                ${material.file ? `<div class="form-text">File saat ini: <a href="${material.file}" target="_blank">Lihat</a></div>` : ''}
                            </div>
                        </div>
                    `;
                    
                    container.innerHTML += materialHtml;
                }
            }
            
            // Fungsi untuk load form test
            function loadTestForms() {
                const tests = JSON.parse(localStorage.getItem('tests'));
                const pretest = tests.pretest || [];
                const posttest = tests.posttest || [];
                
                const pretestContainer = document.getElementById('pretestContainer');
                const posttestContainer = document.getElementById('posttestContainer');
                
                pretestContainer.innerHTML = '';
                posttestContainer.innerHTML = '';
                
                // Load pre-test
                for (let i = 0; i < 10; i++) {
                    const question = pretest[i] || { question: '', options: ['', '', '', ''], answer: 0 };
                    
                    const questionHtml = `
                        <div class="material-input-group">
                            <h6>Soal Pre-test ${i + 1}</h6>
                            <div class="mb-2">
                                <label class="form-label">Pertanyaan</label>
                                <input type="text" class="form-control pretest-question" data-index="${i}" value="${question.question}" placeholder="Masukkan pertanyaan">
                            </div>
                            <div class="mb-2">
                                <label class="form-label">Opsi Jawaban</label>
                                ${question.options.map((option, idx) => `
                                    <div class="input-group mb-1">
                                        <span class="input-group-text">${idx + 1}</span>
                                        <input type="text" class="form-control pretest-option" data-index="${i}" data-option="${idx}" value="${option}" placeholder="Opsi jawaban ${idx + 1}">
                                    </div>
                                `).join('')}
                            </div>
                            <div class="mb-2">
                                <label class="form-label">Jawaban Benar</label>
                                <select class="form-control pretest-answer" data-index="${i}">
                                    ${question.options.map((_, idx) => `
                                        <option value="${idx}" ${question.answer === idx ? 'selected' : ''}>Opsi ${idx + 1}</option>
                                    `).join('')}
                                </select>
                            </div>
                        </div>
                    `;
                    
                    pretestContainer.innerHTML += questionHtml;
                }
                
                // Load post-test
                for (let i = 0; i < 10; i++) {
                    const question = posttest[i] || { question: '', options: ['', '', '', ''], answer: 0 };
                    
                    const questionHtml = `
                        <div class="material-input-group">
                            <h6>Soal Post-test ${i + 1}</h6>
                            <div class="mb-2">
                                <label class="form-label">Pertanyaan</label>
                                <input type="text" class="form-control posttest-question" data-index="${i}" value="${question.question}" placeholder="Masukkan pertanyaan">
                            </div>
                            <div class="mb-2">
                                <label class="form-label">Opsi Jawaban</label>
                                ${question.options.map((option, idx) => `
                                    <div class="input-group mb-1">
                                        <span class="input-group-text">${idx + 1}</span>
                                        <input type="text" class="form-control posttest-option" data-index="${i}" data-option="${idx}" value="${option}" placeholder="Opsi jawaban ${idx + 1}">
                                    </div>
                                `).join('')}
                            </div>
                            <div class="mb-2">
                                <label class="form-label">Jawaban Benar</label>
                                <select class="form-control posttest-answer" data-index="${i}">
                                    ${question.options.map((_, idx) => `
                                        <option value="${idx}" ${question.answer === idx ? 'selected' : ''}>Opsi ${idx + 1}</option>
                                    `).join('')}
                                </select>
                            </div>
                        </div>
                    `;
                    
                    posttestContainer.innerHTML += questionHtml;
                }
            }
            
            // Fungsi untuk update akses materi berdasarkan produk yang dimiliki
            function updateMaterialAccess() {
                const products = currentUser.products || [];
                
                // Daftar semua materi
                const materials = ['beginner', 'intermediate', 'advanced', 'ar', 'pdf'];
                
                materials.forEach(material => {
                    const materialElement = document.getElementById(`material-${material}`);
                    if (materialElement) {
                        if (products.includes(material)) {
                            materialElement.classList.remove('material-locked');
                            
                            // Update badge di produk
                            const badge = document.querySelector(`.access-badge[data-product="${material}"]`);
                            if (badge) {
                                badge.textContent = 'Akses Tersedia';
                                badge.classList.remove('access-badge');
                                badge.classList.add('paid-badge');
                            }
                            
                            // Tampilkan tombol akses link khusus untuk produk AR
                            if (material === 'ar') {
                                const accessSection = materialElement.querySelector('.material-access');
                                if (accessSection) {
                                    accessSection.style.display = 'block';
                                }
                            }
                        } else {
                            materialElement.classList.add('material-locked');
                            
                            // Update badge di produk
                            const badge = document.querySelector(`.access-badge[data-product="${material}"]`);
                            if (badge) {
                                badge.textContent = 'Materi Terkunci';
                                badge.classList.remove('paid-badge');
                                badge.classList.add('access-badge');
                            }
                        }
                    }
                });
            }
            
            // Fungsi untuk update badge produk
            function updateProductBadges() {
                const products = currentUser.products || [];
                
                products.forEach(product => {
                    const badge = document.querySelector(`.access-badge[data-product="${product}"]`);
                    if (badge) {
                        badge.textContent = 'Akses Tersedia';
                        badge.classList.remove('access-badge');
                        badge.classList.add('paid-badge');
                    }
                });
            }
            
            // Fungsi untuk update tombol "Beli Sekarang" menjadi "Akses Materi" untuk produk yang sudah dibeli
            function updateBuyButtons() {
                if (!currentUser || !currentUser.products) return;
                
                const products = currentUser.products;
                const buttons = document.querySelectorAll('.buy-btn');
                
                buttons.forEach(button => {
                    const productKey = button.getAttribute('data-product-key');
                    if (products.includes(productKey)) {
                        if (productKey === 'ar') {
                            button.textContent = 'Akses Link';
                        } else {
                            button.textContent = 'Akses Materi';
                        }
                        button.classList.remove('btn-primary');
                        button.classList.add('btn-success');
                        button.setAttribute('data-bs-target', '#');
                        button.onclick = function() {
                            // Redirect ke katalog
                            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                            document.querySelector('.nav-link[data-bs-target="catalog"]').classList.add('active');
                            showSection('catalog');
                        };
                    }
                });
            }
            
            // Fungsi untuk update daftar produk user di profil
            function updateUserProducts() {
                const userProductsContainer = document.getElementById('userProducts');
                const products = currentUser.products || [];
                
                if (products.length === 0) {
                    userProductsContainer.innerHTML = '<p class="text-muted">Anda belum membeli produk apapun.</p>';
                } else {
                    let html = '<div class="list-group">';
                    
                    products.forEach(product => {
                        let productName = '';
                        switch(product) {
                            case 'beginner':
                                productName = 'Beginner Sempoa';
                                break;
                            case 'intermediate':
                                productName = 'Intermediate Sempoa';
                                break;
                            case 'advanced':
                                productName = 'Advanced Sempoa';
                                break;
                            case 'ar':
                                productName = 'Akses Link AR';
                                break;
                            case 'pdf':
                                productName = 'Materi PDF';
                                break;
                            default:
                                productName = product;
                        }
                        
                        html += `
                            <div class="list-group-item d-flex justify-content-between align-items-center">
                                ${productName}
                                <span class="paid-badge">Telah Dibeli</span>
                            </div>
                        `;
                    });
                    
                    html += '</div>';
                    userProductsContainer.innerHTML = html;
                }
            }
            
            // Fungsi untuk update data affiliate
            function updateAffiliateData() {
                if (!currentUser.affiliateCode) {
                    // Generate kode affiliate jika belum ada
                    const affiliateCode = generateAffiliateCode();
                    const users = JSON.parse(localStorage.getItem('users'));
                    const userIndex = users.findIndex(u => u.username === currentUser.username);
                    
                    users[userIndex].affiliateCode = affiliateCode;
                    localStorage.setItem('users', JSON.stringify(users));
                    
                    currentUser.affiliateCode = affiliateCode;
                }
                
                // Tampilkan kode affiliate
                document.getElementById('userAffiliateCode').textContent = currentUser.affiliateCode;
                document.getElementById('flyerAffiliateCode').textContent = currentUser.affiliateCode;
                document.getElementById('storyAffiliateCode').textContent = currentUser.affiliateCode;
                
                // Generate affiliate link
                const affiliateLink = `${window.location.origin}${window.location.pathname}?ref=${currentUser.affiliateCode}`;
                
                // Hitung jumlah pengguna yang mendaftar dengan kode affiliate ini
                const users = JSON.parse(localStorage.getItem('users'));
                const affiliateUsers = users.filter(u => u.affiliatedBy === currentUser.username);
                document.getElementById('affiliateCount').textContent = affiliateUsers.length;
                
                // Hitung total komisi
                const payments = JSON.parse(localStorage.getItem('payments'));
                let totalEarnings = 0;
                let affiliateStats = '';
                
                affiliateUsers.forEach(user => {
                    const userPayments = payments.filter(p => p.username === user.username && p.status === 'verified');
                    
                    userPayments.forEach(payment => {
                        const commission = parseInt(payment.price) * 0.1; // 10% komisi
                        totalEarnings += commission;
                        
                        affiliateStats += `
                            <tr>
                                <td>${user.username}</td>
                                <td>${new Date(payment.date).toLocaleDateString('id-ID')}</td>
                                <td>Rp ${commission.toLocaleString('id-ID')}</td>
                            </tr>
                        `;
                    });
                });
                
                document.getElementById('affiliateEarnings').textContent = `Rp ${totalEarnings.toLocaleString('id-ID')}`;
                document.getElementById('affiliateStats').innerHTML = affiliateStats || '<tr><td colspan="3" class="text-center">Belum ada komisi</td></tr>';
            }
            
            // Fungsi untuk update data profil
            function updateProfileData() {
                if (currentUser.affiliateCode) {
                    document.getElementById('profileAffiliateBadge').style.display = 'block';
                    document.getElementById('affiliateInfoCard').style.display = 'block';
                    document.getElementById('affiliateCodeValue').textContent = currentUser.affiliateCode;
                    
                    // Load riwayat affiliate
                    const users = JSON.parse(localStorage.getItem('users'));
                    const payments = JSON.parse(localStorage.getItem('payments'));
                    const affiliateUsers = users.filter(u => u.affiliatedBy === currentUser.username);
                    let affiliateHistory = '';
                    
                    affiliateUsers.forEach(user => {
                        const userPayments = payments.filter(p => p.username === user.username && p.status === 'verified');
                        
                        userPayments.forEach(payment => {
                            const commission = parseInt(payment.price) * 0.1;
                            
                            affiliateHistory += `
                                <tr>
                                    <td>${user.username}</td>
                                    <td>${new Date(payment.date).toLocaleDateString('id-ID')}</td>
                                    <td>${payment.product}</td>
                                    <td>Rp ${commission.toLocaleString('id-ID')}</td>
                                </tr>
                            `;
                        });
                    });
                    
                    document.getElementById('affiliateHistory').innerHTML = affiliateHistory || '<tr><td colspan="4" class="text-center">Belum ada riwayat affiliate</td></tr>';
                    document.getElementById('affiliateHistoryCard').style.display = 'block';
                }
            }
            
            // Fungsi untuk generate kode affiliate
            function generateAffiliateCode() {
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
                let code = '';
                for (let i = 0; i < 8; i++) {
                    code += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                return code;
            }
            
            // Fungsi untuk login
            function loginUser(username, password) {
                const users = JSON.parse(localStorage.getItem('users'));
                const user = users.find(u => u.username === username && u.password === password);
                
                if (user) {
                    currentUser = user;
                    
                    // Cek jika admin
                    if (username === 'admin' && password === 'admin123') {
                        isAdmin = true;
                        document.querySelector('.user-section').style.display = 'none';
                        document.querySelector('.admin-section').style.display = 'block';
                        document.getElementById('userRole').style.display = 'inline';
                        document.getElementById('userRole').textContent = 'Admin';
                        
                        // Load data admin
                        loadAdminData();
                        loadPdfMaterialsForm();
                        loadVideoMaterialsForm();
                        loadTestForms();
                        
                        // Load link settings
                        const links = JSON.parse(localStorage.getItem('links'));
                        document.getElementById('zoomLinkInput').value = links.zoom || '';
                        document.getElementById('arLinkInput').value = links.ar || '';
                        
                        showAlert('Login admin berhasil!', 'success');
                    } else {
                        isAdmin = false;
                        document.querySelector('.user-section').style.display = 'block';
                        document.querySelector('.admin-section').style.display = 'none';
                        
                        // Tampilkan badge affiliate jika ada
                        if (currentUser.affiliateCode) {
                            document.getElementById('userAffiliate').style.display = 'inline';
                        }
                        
                        // Tampilkan badge premium jika ada produk
                        if (user.products && user.products.length > 0) {
                            document.getElementById('userStatus').style.display = 'inline';
                            document.getElementById('profileStatusBadge').style.display = 'block';
                        }
                        
                        // Update tombol beli
                        updateBuyButtons();
                    }
                    
                    // Update UI setelah login
                    document.getElementById('loginFormContainer').style.display = 'none';
                    document.getElementById('userInfoContainer').style.display = 'flex';
                    document.getElementById('userName').textContent = user.username;
                    document.getElementById('userAvatar').textContent = user.username.charAt(0).toUpperCase();
                    
                    // Update profil
                    document.getElementById('profileName').textContent = user.username;
                    document.getElementById('profileWhatsapp').textContent = `WhatsApp: ${user.whatsapp}`;
                    document.getElementById('profileAvatar').textContent = user.username.charAt(0).toUpperCase();
                    
                    // Sembunyikan notifikasi login di trial modal
                    document.getElementById('trialLoginNotice').style.display = 'none';
                    
                    // Cek trial count
                    const trials = JSON.parse(localStorage.getItem('trials'));
                    const userTrials = trials.filter(t => t.username === user.username);
                    
                    if (userTrials.length < 2) {
                        document.getElementById('trialContent').style.display = 'block';
                        document.getElementById('trialCount').textContent = 2 - userTrials.length;
                        document.getElementById('trialPromo').style.display = 'none';
                    } else {
                        document.getElementById('trialLimitNotice').style.display = 'flex';
                        document.getElementById('trialContent').style.display = 'none';
                        document.getElementById('trialPromo').style.display = 'block';
                    }
                    
                    showAlert('Login berhasil!', 'success');
                    return true;
                } else {
                    showAlert('Username atau password salah!', 'danger');
                    return false;
                }
            }
            
            // Fungsi untuk logout
            function logoutUser() {
                currentUser = null;
                isAdmin = false;
                
                // Update UI setelah logout
                document.getElementById('loginFormContainer').style.display = 'block';
                document.getElementById('userInfoContainer').style.display = 'none';
                document.getElementById('userRole').style.display = 'none';
                document.getElementById('userStatus').style.display = 'none';
                document.getElementById('userAffiliate').style.display = 'none';
                document.querySelector('.user-section').style.display = 'block';
                document.querySelector('.admin-section').style.display = 'none';
                
                // Reset form login
                document.getElementById('loginForm').reset();
                
                // Tampilkan notifikasi login di trial modal
                document.getElementById('trialLoginNotice').style.display = 'flex';
                document.getElementById('trialContent').style.display = 'none';
                document.getElementById('trialLimitNotice').style.display = 'none';
                document.getElementById('trialPromo').style.display = 'none';
                
                showAlert('Anda telah logout.', 'info');
            }
            
            // Fungsi untuk load data admin
            function loadAdminData() {
                // Load data pengguna
                const users = JSON.parse(localStorage.getItem('users'));
                document.getElementById('userCount').textContent = users.length;
                
                // Load data pembayaran
                const payments = JSON.parse(localStorage.getItem('payments'));
                document.getElementById('totalSales').textContent = payments.length;
                
                // Hitung total pendapatan
                let totalRevenue = 0;
                payments.forEach(payment => {
                    totalRevenue += parseInt(payment.price);
                });
                document.getElementById('totalRevenue').textContent = `Rp ${totalRevenue.toLocaleString('id-ID')}`;
                
                // Load daftar pengguna
                const usersList = document.getElementById('usersList');
                usersList.innerHTML = '';
                
                users.forEach(user => {
                    if (user.username !== 'admin') {
                        const products = user.products || [];
                        const productsText = products.map(p => {
                            switch(p) {
                                case 'beginner': return 'Beginner';
                                case 'intermediate': return 'Intermediate';
                                case 'advanced': return 'Advanced';
                                case 'ar': return 'AR';
                                case 'pdf': return 'PDF';
                                default: return p;
                            }
                        }).join(', ');
                        
                        usersList.innerHTML += `
                            <tr>
                                <td>${user.username}</td>
                                <td>${user.whatsapp}</td>
                                <td>${productsText || 'Tidak ada'}</td>
                                <td>${new Date(user.registeredAt).toLocaleDateString('id-ID')}</td>
                                <td>
                                    <button class="btn btn-sm btn-info view-user" data-username="${user.username}">Lihat</button>
                                </td>
                            </tr>
                        `;
                    }
                });
                
                // Load daftar pembayaran
                const paymentsList = document.getElementById('paymentsList');
                paymentsList.innerHTML = '';
                
                payments.forEach(payment => {
                    paymentsList.innerHTML += `
                        <tr>
                            <td>${payment.username}</td>
                            <td>${payment.product}</td>
                            <td>Rp ${parseInt(payment.price).toLocaleString('id-ID')}</td>
                            <td>${payment.method}</td>
                            <td><span class="badge bg-${payment.status === 'verified' ? 'success' : payment.status === 'rejected' ? 'danger' : 'warning'}">${payment.status}</span></td>
                            <td>${new Date(payment.date).toLocaleDateString('id-ID')}</td>
                            <td>
                                <button class="btn btn-sm btn-info view-payment" data-proof="${payment.proof}" data-username="${payment.username}" data-product="${payment.product}" data-date="${payment.date}">Lihat Bukti</button>
                                ${payment.status === 'pending' ? 
                                    `<button class="btn btn-sm btn-success verify-payment" data-id="${payment.date}" data-action="verify">Verifikasi</button>
                                     <button class="btn btn-sm btn-danger verify-payment" data-id="${payment.date}" data-action="reject">Tolak</button>` : ''}
                            </td>
                        </tr>
                    `;
                });
            }
            
            // Fungsi untuk update grafik penjualan
            function updateSalesChart() {
                const payments = JSON.parse(localStorage.getItem('payments'));
                const verifiedPayments = payments.filter(p => p.status === 'verified');
                
                // Kelompokkan pembayaran berdasarkan bulan
                const monthlySales = {};
                verifiedPayments.forEach(payment => {
                    const date = new Date(payment.date);
                    const monthYear = `${date.getFullYear()}-${date.getMonth() + 1}`;
                    
                    if (!monthlySales[monthYear]) {
                        monthlySales[monthYear] = 0;
                    }
                    
                    monthlySales[monthYear] += parseInt(payment.price);
                });
                
                // Urutkan berdasarkan bulan
                const sortedMonths = Object.keys(monthlySales).sort();
                const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Ags', 'Sep', 'Okt', 'Nov', 'Des'];
                
                const labels = sortedMonths.map(month => {
                    const [year, monthNum] = month.split('-');
                    return `${monthNames[parseInt(monthNum) - 1]} ${year}`;
                });
                
                const data = sortedMonths.map(month => monthlySales[month]);
                
                // Buat atau update chart
                const ctx = document.getElementById('salesChart').getContext('2d');
                
                if (salesChart) {
                    salesChart.destroy();
                }
                
                salesChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Penjualan per Bulan',
                            data: data,
                            backgroundColor: 'rgba(139, 90, 43, 0.2)',
                            borderColor: 'rgba(139, 90, 43, 1)',
                            borderWidth: 2,
                            tension: 0.3,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return 'Rp ' + value.toLocaleString('id-ID');
                                    }
                                }
                            }
                        },
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return 'Rp ' + context.raw.toLocaleString('id-ID');
                                    }
                                }
                            }
                        }
                    }
                });
            }
            
            // Fungsi untuk menampilkan test
            function showTest(testType, productKey) {
                if (!currentUser) {
                    showAlert('Silakan login terlebih dahulu untuk mengikuti test.', 'warning');
                    return;
                }
                
                if (!currentUser.products || !currentUser.products.includes(productKey)) {
                    showAlert('Anda belum membeli produk ini. Silakan beli terlebih dahulu.', 'warning');
                    return;
                }
                
                const tests = JSON.parse(localStorage.getItem('tests'));
                const testQuestions = tests[testType === 'pre' ? 'pretest' : 'posttest'];
                
                if (testQuestions.length === 0) {
                    showAlert('Soal test belum tersedia.', 'info');
                    return;
                }
                
                let testHtml = `
                    <h4 class="text-center">${testType === 'pre' ? 'Pre-test' : 'Post-test'} - ${getProductName(productKey)}</h4>
                    <form id="testForm">
                `;
                
                testQuestions.forEach((question, index) => {
                    testHtml += `
                        <div class="test-question">
                            <p><strong>${index + 1}. ${question.question}</strong></p>
                            <div class="test-options">
                                ${question.options.map((option, idx) => `
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="question${index}" id="q${index}option${idx}" value="${idx}" required>
                                        <label class="form-check-label" for="q${index}option${idx}">
                                            ${option}
                                        </label>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                });
                
                testHtml += `
                        <div class="d-grid gap-2 mt-4">
                            <button type="submit" class="btn btn-primary">Submit Test</button>
                        </div>
                    </form>
                    <div class="test-result" id="testResult" style="display: none;">
                        <h4>Hasil Test</h4>
                        <div class="score-display" id="testScore">0/10</div>
                        <p id="testFeedback"></p>
                        <button class="btn btn-outline-primary mt-3" data-bs-dismiss="modal">Tutup</button>
                    </div>
                `;
                
                document.getElementById('testContent').innerHTML = testHtml;
                document.getElementById('testModalLabel').textContent = `${testType === 'pre' ? 'Pre-test' : 'Post-test'} - ${getProductName(productKey)}`;
                
                const testModal = new bootstrap.Modal(document.getElementById('testModal'));
                testModal.show();
                
                // Event listener untuk submit test
                document.getElementById('testForm').addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    let score = 0;
                    const formData = new FormData(this);
                    
                    testQuestions.forEach((question, index) {
                        const userAnswer = parseInt(formData.get(`question${index}`));
                        if (userAnswer === question.answer) {
                            score++;
                        }
                    });
                    
                    const percentage = (score / testQuestions.length) * 100;
                    let feedback = '';
                    
                    if (percentage >= 80) {
                        feedback = 'Selamat! Anda telah lulus test dengan nilai yang sangat baik.';
                    } else if (percentage >= 60) {
                        feedback = 'Anda telah lulus test. Pertahankan dan terus belajar!';
                    } else {
                        feedback = 'Maaf, Anda belum lulus test. Silakan pelajari materi kembali dan coba lagi.';
                    }
                    
                    document.getElementById('testForm').style.display = 'none';
                    document.getElementById('testResult').style.display = 'block';
                    document.getElementById('testScore').textContent = `${score}/${testQuestions.length}`;
                    document.getElementById('testFeedback').textContent = feedback;
                    
                    // Simpan hasil test
                    if (!currentUser.testResults) {
                        currentUser.testResults = {};
                    }
                    
                    if (!currentUser.testResults[productKey]) {
                        currentUser.testResults[productKey] = {};
                    }
                    
                    currentUser.testResults[productKey][testType] = {
                        score: score,
                        total: testQuestions.length,
                        date: new Date().toISOString()
                    };
                    
                    // Update user data
                    const users = JSON.parse(localStorage.getItem('users'));
                    const userIndex = users.findIndex(u => u.username === currentUser.username);
                    if (userIndex !== -1) {
                        users[userIndex] = currentUser;
                        localStorage.setItem('users', JSON.stringify(users));
                    }
                });
            }
            
            // Fungsi untuk mendapatkan nama produk dari key
            function getProductName(productKey) {
                switch(productKey) {
                    case 'beginner': return 'Beginner Sempoa';
                    case 'intermediate': return 'Intermediate Sempoa';
                    case 'advanced': return 'Advanced Sempoa';
                    case 'ar': return 'Akses Link AR';
                    case 'pdf': return 'Materi PDF';
                    default: return productKey;
                }
            }
            
            // Fungsi untuk generate invoice
            function generateInvoice(paymentData) {
                const invoiceContent = document.getElementById('invoiceContent');
                
                const invoiceHtml = `
                    <div class="invoice-header">
                        <h3>EonGenesis.id</h3>
                        <p>Kursus Sempoa Modern dengan Teknologi AR</p>
                        <p>Invoice: INV-${new Date().getTime()}</p>
                    </div>
                    
                    <div class="invoice-details">
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Detail Pelanggan:</h5>
                                <p>Nama: ${paymentData.username}</p>
                                <p>WhatsApp: ${currentUser.whatsapp}</p>
                            </div>
                            <div class="col-md-6">
                                <h5>Detail Pembayaran:</h5>
                                <p>Tanggal: ${new Date(paymentData.date).toLocaleDateString('id-ID')}</p>
                                <p>Status: <span class="text-success">Lunas</span></p>
                            </div>
                        </div>
                    </div>
                    
                    <table class="invoice-table">
                        <thead>
                            <tr>
                                <th>Deskripsi</th>
                                <th>Jumlah</th>
                                <th>Harga</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>${paymentData.product}</td>
                                <td>1</td>
                                <td>Rp ${parseInt(paymentData.price).toLocaleString('id-ID')}</td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="2" class="invoice-total">Total:</td>
                                <td class="invoice-total">Rp ${parseInt(paymentData.price).toLocaleString('id-ID')}</td>
                            </tr>
                        </tfoot>
                    </table>
                    
                    <div class="mt-4">
                        <p>Terima kasih telah berbelanja di EonGenesis.id. Invoice ini merupakan bukti pembayaran yang sah.</p>
                    </div>
                `;
                
                invoiceContent.innerHTML = invoiceHtml;
                
                const invoiceModal = new bootstrap.Modal(document.getElementById('invoiceModal'));
                invoiceModal.show();
            }
            
            // Event listener untuk form login
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const username = document.getElementById('loginUsername').value;
                const password = document.getElementById('loginPassword').value;
                
                loginUser(username, password);
            });
            
            // Event listener untuk tombol logout
            document.getElementById('logoutBtn').addEventListener('click', logoutUser);
            
            // Event listener untuk navigasi
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Update class active
                    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Tampilkan section yang sesuai
                    const target = this.getAttribute('data-bs-target');
                    showSection(target);
                });
            });
            
            // Event listener untuk menu admin
            document.querySelectorAll('.admin-menu-item').forEach(item => {
                item.addEventListener('click', function() {
                    // Update class active
                    document.querySelectorAll('.admin-menu-item').forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Tampilkan content yang sesuai
                    const target = this.getAttribute('data-target');
                    document.querySelectorAll('.admin-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(`admin-${target}`).classList.add('active');
                });
            });
            
            // Event listener untuk penggunaan trial
            document.getElementById('useTrial').addEventListener('click', function() {
                const trials = JSON.parse(localStorage.getItem('trials'));
                const userTrials = trials.filter(t => t.username === currentUser.username);
                
                if (userTrials.length < 2) {
                    // Tambahkan trial
                    trials.push({
                        username: currentUser.username,
                        date: new Date().toISOString()
                    });
                    
                    localStorage.setItem('trials', JSON.stringify(trials));
                    
                    // Update tampilan
                    document.getElementById('trialCount').textContent = 2 - (userTrials.length + 1);
                    
                    // Redirect ke AR
                    const links = JSON.parse(localStorage.getItem('links'));
                    window.open(links.ar, '_blank');
                    
                    if (userTrials.length + 1 >= 2) {
                        // Trial habis
                        document.getElementById('trialContent').style.display = 'none';
                        document.getElementById('trialPromo').style.display = 'block';
                    }
                }
            });
            
            // Event listener untuk pendaftaran
            document.getElementById('submitRegister').addEventListener('click', function() {
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                const whatsapp = document.getElementById('whatsapp').value;
                const affiliateCode = document.getElementById('affiliateCode').value;
                
                // Validasi nomor WhatsApp
                const whatsappRegex = /^08[0-9]{9,11}$/;
                if (!whatsappRegex.test(whatsapp)) {
                    showAlert('Nomor WhatsApp harus 13 digit dan dimulai dengan 08!', 'danger');
                    return;
                }
                
                const users = JSON.parse(localStorage.getItem('users'));
                
                // Cek apakah username sudah ada
                if (users.find(u => u.username === username)) {
                    document.getElementById('usernameError').style.display = 'block';
                    return;
                } else {
                    document.getElementById('usernameError').style.display = 'none';
                }
                
                // Cek apakah WhatsApp sudah ada
                if (users.find(u => u.whatsapp === whatsapp)) {
                    document.getElementById('whatsappError').style.display = 'block';
                    return;
                } else {
                    document.getElementById('whatsappError').style.display = 'none';
                }
                
                // Cek kode affiliate jika diisi
                let affiliatedBy = null;
                if (affiliateCode) {
                    const affiliateUser = users.find(u => u.affiliateCode === affiliateCode);
                    if (!affiliateUser) {
                        document.getElementById('affiliateError').style.display = 'block';
                        return;
                    } else {
                        document.getElementById('affiliateError').style.display = 'none';
                        affiliatedBy = affiliateUser.username;
                    }
                }
                
                // Tambahkan user baru
                users.push({
                    username,
                    password,
                    whatsapp,
                    affiliatedBy,
                    products: [],
                    registeredAt: new Date().toISOString()
                });
                
                localStorage.setItem('users', JSON.stringify(users));
                
                // Tutup modal dan reset form
                const registerModal = bootstrap.Modal.getInstance(document.getElementById('registerModal'));
                registerModal.hide();
                document.getElementById('registerForm').reset();
                
                showAlert('Pendaftaran berhasil! Silakan login.', 'success');
            });
            
            // Event listener untuk tombol beli
            document.querySelectorAll('.buy-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    if (!currentUser) {
                        showAlert('Silakan login terlebih dahulu untuk membeli produk.', 'warning');
                        return;
                    }
                    
                    const productName = this.getAttribute('data-product');
                    const productPrice = this.getAttribute('data-price');
                    const productKey = this.getAttribute('data-product-key');
                    
                    // Cek apakah produk sudah dibeli
                    if (currentUser.products && currentUser.products.includes(productKey)) {
                        // Jika produk AR, arahkan ke link AR
                        if (productKey === 'ar') {
                            const links = JSON.parse(localStorage.getItem('links'));
                            window.open(links.ar, '_blank');
                            return;
                        }
                        
                        // Redirect ke katalog
                        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                        document.querySelector('.nav-link[data-bs-target="catalog"]').classList.add('active');
                        showSection('catalog');
                        return;
                    }
                    
                    document.getElementById('paymentProductName').textContent = productName;
                    document.getElementById('paymentProductPrice').textContent = `Rp ${parseInt(productPrice).toLocaleString('id-ID')}`;
                    
                    // Simpan data produk yang dipilih di button untuk referensi nanti
                    const confirmBtn = document.getElementById('confirmPayment');
                    confirmBtn.setAttribute('data-product', productName);
                    confirmBtn.setAttribute('data-price', productPrice);
                    confirmBtn.setAttribute('data-product-key', productKey);
                    
                    // Reset voucher
                    appliedVoucher = null;
                    document.getElementById('voucherApplied').style.display = 'none';
                    document.getElementById('voucherMessage').textContent = '';
                    document.getElementById('voucherCode').value = '';
                    
                    const paymentModal = new bootstrap.Modal(document.getElementById('paymentModal'));
                    paymentModal.show();
                });
            });
            
            // Event listener untuk metode pembayaran
            document.querySelectorAll('.payment-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.payment-option').forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    const method = this.getAttribute('data-method');
                    document.querySelector(`#${method}Method`).checked = true;
                    
                    // Tampilkan detail sesuai metode
                    if (method === 'qris') {
                        document.getElementById('qrisCode').style.display = 'block';
                        document.getElementById('bankTransferDetails').style.display = 'none';
                    } else {
                        document.getElementById('qrisCode').style.display = 'none';
                        document.getElementById('bankTransferDetails').style.display = 'block';
                    }
                });
            });
            
            // Event listener untuk aplikasikan voucher
            document.getElementById('applyVoucher').addEventListener('click', function() {
                const voucherCode = document.getElementById('voucherCode').value;
                const vouchers = JSON.parse(localStorage.getItem('vouchers'));
                const voucher = vouchers.find(v => v.code === voucherCode && !v.used);
                
                if (voucher) {
                    appliedVoucher = voucher;
                    
                    // Hitung harga setelah diskon
                    const originalPrice = parseInt(document.getElementById('confirmPayment').getAttribute('data-price'));
                    const discountedPrice = originalPrice - (originalPrice * voucher.discount / 100);
                    
                    document.getElementById('paymentProductPrice').textContent = `Rp ${discountedPrice.toLocaleString('id-ID')}`;
                    document.getElementById('voucherApplied').style.display = 'block';
                    document.getElementById('voucherMessage').textContent = `Voucher berhasil diterapkan! Diskon ${voucher.discount}%`;
                    document.getElementById('voucherMessage').className = 'form-text text-success';
                    
                    // Update harga di tombol konfirmasi
                    document.getElementById('confirmPayment').setAttribute('data-price', discountedPrice);
                } else {
                    document.getElementById('voucherMessage').textContent = 'Kode voucher tidak valid atau sudah digunakan';
                    document.getElementById('voucherMessage').className = 'form-text text-danger';
                }
            });
            
            // Event listener untuk konfirmasi pembayaran
            document.getElementById('confirmPayment').addEventListener('click', function() {
                const productName = this.getAttribute('data-product');
                const productPrice = this.getAttribute('data-price');
                const productKey = this.getAttribute('data-product-key');
                const paymentMethod = document.querySelector('input[name="paymentMethod"]:checked').value;
                const proofPayment = document.getElementById('proofPayment').files[0];
                
                if (!proofPayment) {
                    showAlert('Harap upload bukti pembayaran.', 'warning');
                    return;
                }
                
                // Validasi format file
                const allowedExtensions = /(\.jpg|\.jpeg)$/i;
                if (!allowedExtensions.exec(proofPayment.name)) {
                    showAlert('Hanya file JPG yang diperbolehkan.', 'warning');
                    return;
                }
                
                // Cek apakah pembayaran untuk produk yang sama sedang dalam proses
                const payments = JSON.parse(localStorage.getItem('payments'));
                const pendingPayment = payments.find(p => 
                    p.username === currentUser.username && 
                    p.product === productName && 
                    p.status === 'pending'
                );
                
                if (pendingPayment) {
                    showAlert('Pembayaran Anda untuk produk ini sedang ditinjau oleh admin.', 'info');
                    const paymentModal = bootstrap.Modal.getInstance(document.getElementById('paymentModal'));
                    paymentModal.hide();
                    return;
                }
                
                // Simpan data pembayaran
                const paymentData = {
                    username: currentUser.username,
                    product: productName,
                    price: productPrice,
                    method: paymentMethod,
                    proof: URL.createObjectURL(proofPayment), // Simpan sebagai URL (hanya simulasi)
                    status: 'pending',
                    date: new Date().toISOString()
                };
                
                payments.push(paymentData);
                localStorage.setItem('payments', JSON.stringify(payments));
                
                // Tandai voucher sebagai digunakan jika ada
                if (appliedVoucher) {
                    const vouchers = JSON.parse(localStorage.getItem('vouchers'));
                    const voucherIndex = vouchers.findIndex(v => v.code === appliedVoucher.code);
                    if (voucherIndex !== -1) {
                        vouchers[voucherIndex].used = true;
                        localStorage.setItem('vouchers', JSON.stringify(vouchers));
                    }
                }
                
                // Tutup modal
                const paymentModal = bootstrap.Modal.getInstance(document.getElementById('paymentModal'));
                paymentModal.hide();
                
                showAlert('Pembayaran berhasil dikonfirmasi! Produk akan segera diaktifkan setelah verifikasi.', 'success');
            });
            
            // Event listener untuk tombol beli setelah trial habis
            document.getElementById('buyAfterTrial').addEventListener('click', function() {
                if (!currentUser) {
                    showAlert('Silakan login terlebih dahulu untuk membeli produk.', 'warning');
                    return;
                }
                
                const productName = this.getAttribute('data-product');
                const productPrice = this.getAttribute('data-price');
                
                document.getElementById('paymentProductName').textContent = productName;
                document.getElementById('paymentProductPrice').textContent = `Rp ${parseInt(productPrice).toLocaleString('id-ID')}`;
                
                document.getElementById('confirmPayment').setAttribute('data-product', productName);
                document.getElementById('confirmPayment').setAttribute('data-price', productPrice);
                document.getElementById('confirmPayment').setAttribute('data-product-key', 'ar');
                
                const paymentModal = new bootstrap.Modal(document.getElementById('paymentModal'));
                paymentModal.show();
            });
            
            // Event listener untuk tombol akses materi
            document.querySelectorAll('.access-material-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const productKey = this.getAttribute('data-product');
                    
                    if (!currentUser) {
                        showAlert('Silakan login terlebih dahulu untuk mengakses materi.', 'warning');
                        return;
                    }
                    
                    if (!currentUser.products || !currentUser.products.includes(productKey)) {
                        showAlert('Anda belum membeli produk ini. Silakan beli terlebih dahulu.', 'warning');
                        return;
                    }
                    
                    // Redirect ke materi berdasarkan produk
                    const materials = JSON.parse(localStorage.getItem('materials'));
                    
                    switch(productKey) {
                        case 'beginner':
                        case 'intermediate':
                        case 'advanced':
                            if (materials.pdf && materials.pdf.length > 0) {
                                // Buka PDF pertama sebagai contoh
                                window.open(materials.pdf[0].file, '_blank');
                            } else {
                                showAlert('Materi belum tersedia.', 'info');
                            }
                            break;
                        case 'pdf':
                            if (materials.pdf && materials.pdf.length > 0) {
                                // Buka PDF pertama sebagai contoh (hanya view, tidak bisa download)
                                const pdfWindow = window.open(materials.pdf[0].file, '_blank');
                                // Nonaktifkan menu download (hanya simulasi, tidak sepenuhnya aman)
                                setTimeout(() => {
                                    if (pdfWindow && !pdfWindow.closed) {
                                        try {
                                            pdfWindow.document.addEventListener('contextmenu', e => e.preventDefault());
                                        } catch (e) {
                                            console.log('Tidak dapat menonaktifkan menu download');
                                        }
                                    }
                                }, 1000);
                            } else {
                                showAlert('Materi belum tersedia.', 'info');
                            }
                            break;
                    }
                });
            });
            
            // Event listener untuk tombol akses link (khusus AR)
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('access-link-btn')) {
                    e.preventDefault();
                    
                    const productKey = e.target.getAttribute('data-product');
                    
                    if (!currentUser) {
                        showAlert('Silakan login terlebih dahulu untuk mengakses link.', 'warning');
                        return;
                    }
                    
                    if (!currentUser.products || !currentUser.products.includes(productKey)) {
                        showAlert('Anda belum membeli produk ini. Silakan beli terlebih dahulu.', 'warning');
                        return;
                    }
                    
                    // Redirect ke link AR
                    const links = JSON.parse(localStorage.getItem('links'));
                    window.open(links.ar, '_blank');
                }
            });
            
            // Event listener untuk tombol test
            document.querySelectorAll('.take-test-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const testType = this.getAttribute('data-test-type');
                    const productKey = this.getAttribute('data-product');
                    
                    showTest(testType, productKey);
                });
            });
            
            // Event listener untuk tombol salin kode affiliate
            document.getElementById('copyAffiliateCode').addEventListener('click', function() {
                const code = document.getElementById('affiliateCodeValue').textContent;
                navigator.clipboard.writeText(code).then(() => {
                    showAlert('Kode affiliate berhasil disalin!', 'success');
                });
            });
            
            document.getElementById('copyAffiliateBtn').addEventListener('click', function() {
                const code = document.getElementById('userAffiliateCode').textContent;
                navigator.clipboard.writeText(code).then(() => {
                    showAlert('Kode affiliate berhasil disalin!', 'success');
                });
            });
            
            // Event listener untuk share WhatsApp
            document.getElementById('shareWhatsApp').addEventListener('click', function() {
                const code = document.getElementById('flyerAffiliateCode').textContent;
                const message = `Hai! Saya ingin berbagi kode affiliate untuk kursus sempoa EonGenesis.id. Gunakan kode ${code} untuk mendapatkan diskon 10%!`;
                const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
                window.open(whatsappUrl, '_blank');
            });
            
            // Event listener untuk generate flyer Instagram Story
            document.getElementById('generateFlyer').addEventListener('click', function() {
                const code = document.getElementById('flyerAffiliateCode').textContent;
                document.getElementById('storyAffiliateCode').textContent = code;
                
                const flyerModal = new bootstrap.Modal(document.getElementById('flyerModal'));
                flyerModal.show();
            });
            
            // Event listener untuk download Instagram Story
            document.getElementById('downloadStory').addEventListener('click', function() {
                const storyElement = document.getElementById('instagramStory');
                
                html2canvas(storyElement).then(canvas => {
                    const dataUrl = canvas.toDataURL('image/png');
                    const link = document.createElement('a');
                    link.download = `eongenesis-story-${currentUser.affiliateCode}.png`;
                    link.href = dataUrl;
                    link.click();
                    
                    showAlert('Instagram Story berhasil didownload!', 'success');
                });
            });
            
            // Event listener untuk share Instagram Story
            document.getElementById('shareStory').addEventListener('click', function() {
                showAlert('Fitur berbagi ke Instagram Story akan membuka aplikasi Instagram. Pastikan Instagram terinstall di perangkat Anda.', 'info');
                
                // Simulasi share ke Instagram
                setTimeout(() => {
                    showAlert('Instagram Story siap dibagikan! Download gambar terlebih dahulu lalu unggah ke Instagram Story Anda.', 'success');
                }, 2000);
            });
            
            // Event listener untuk simpan link
            document.getElementById('saveLinks').addEventListener('click', function() {
                const zoomLink = document.getElementById('zoomLinkInput').value;
                const arLink = document.getElementById('arLinkInput').value;
                
                const links = {
                    zoom: zoomLink,
                    ar: arLink
                };
                
                localStorage.setItem('links', JSON.stringify(links));
                
                // Update link di user section
                document.getElementById('zoomLink').href = zoomLink;
                
                showAlert('Link berhasil disimpan!', 'success');
            });
            
            // Event listener untuk simpan materi PDF
            document.getElementById('savePdfMaterials').addEventListener('click', function() {
                const materials = JSON.parse(localStorage.getItem('materials'));
                const pdfInputs = document.querySelectorAll('.pdf-title');
                
                materials.pdf = [];
                
                pdfInputs.forEach(input => {
                    const index = input.getAttribute('data-index');
                    const title = input.value;
                    const fileInput = document.querySelector(`.pdf-file[data-index="${index}"]`);
                    const file = fileInput.files[0];
                    
                    if (title || file) {
                        materials.pdf.push({
                            title: title,
                            file: file ? URL.createObjectURL(file) : materials.pdf[index]?.file || null
                        });
                    }
                });
                
                localStorage.setItem('materials', JSON.stringify(materials));
                showAlert('Materi PDF berhasil disimpan!', 'success');
            });
            
            // Event listener untuk simpan video tutorial
            document.getElementById('saveVideoMaterials').addEventListener('click', function() {
                const materials = JSON.parse(localStorage.getItem('materials'));
                const videoInputs = document.querySelectorAll('.video-title');
                
                materials.video = [];
                
                videoInputs.forEach(input => {
                    const index = input.getAttribute('data-index');
                    const title = input.value;
                    const fileInput = document.querySelector(`.video-file[data-index="${index}"]`);
                    const file = fileInput.files[0];
                    
                    if (title || file) {
                        materials.video.push({
                            title: title,
                            file: file ? URL.createObjectURL(file) : materials.video[index]?.file || null
                        });
                    }
                });
                
                localStorage.setItem('materials', JSON.stringify(materials));
                showAlert('Video tutorial berhasil disimpan!', 'success');
            });
            
            // Event listener untuk simpan soal test
            document.getElementById('saveTests').addEventListener('click', function() {
                const tests = JSON.parse(localStorage.getItem('tests'));
                
                // Simpan pre-test
                tests.pretest = [];
                const pretestQuestions = document.querySelectorAll('.pretest-question');
                
                pretestQuestions.forEach(input => {
                    const index = input.getAttribute('data-index');
                    const question = input.value;
                    
                    if (question) {
                        const options = [];
                        const optionInputs = document.querySelectorAll(`.pretest-option[data-index="${index}"]`);
                        
                        optionInputs.forEach(optInput => {
                            options.push(optInput.value);
                        });
                        
                        const answer = parseInt(document.querySelector(`.pretest-answer[data-index="${index}"]`).value);
                        
                        tests.pretest.push({
                            question: question,
                            options: options,
                            answer: answer
                        });
                    }
                });
                
                // Simpan post-test
                tests.posttest = [];
                const posttestQuestions = document.querySelectorAll('.posttest-question');
                
                posttestQuestions.forEach(input => {
                    const index = input.getAttribute('data-index');
                    const question = input.value;
                    
                    if (question) {
                        const options = [];
                        const optionInputs = document.querySelectorAll(`.posttest-option[data-index="${index}"]`);
                        
                        optionInputs.forEach(optInput => {
                            options.push(optInput.value);
                        });
                        
                        const answer = parseInt(document.querySelector(`.posttest-answer[data-index="${index}"]`).value);
                        
                        tests.posttest.push({
                            question: question,
                            options: options,
                            answer: answer
                        });
                    }
                });
                
                localStorage.setItem('tests', JSON.stringify(tests));
                showAlert('Soal test berhasil disimpan!', 'success');
            });
            
            // Event listener untuk lihat bukti pembayaran
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('view-payment')) {
                    const proof = e.target.getAttribute('data-proof');
                    const username = e.target.getAttribute('data-username');
                    const product = e.target.getAttribute('data-product');
                    const date = e.target.getAttribute('data-date');
                    
                    document.getElementById('proofImage').src = proof;
                    document.getElementById('proofDetails').innerHTML = `
                        <p><strong>User:</strong> ${username}</p>
                        <p><strong>Produk:</strong> ${product}</p>
                        <p><strong>Tanggal:</strong> ${new Date(date).toLocaleDateString('id-ID')}</p>
                    `;
                    
                    const proofModal = new bootstrap.Modal(document.getElementById('proofModal'));
                    proofModal.show();
                }
            });
            
            // Event listener untuk verifikasi pembayaran
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('verify-payment')) {
                    const paymentId = e.target.getAttribute('data-id');
                    const action = e.target.getAttribute('data-action');
                    const payments = JSON.parse(localStorage.getItem('payments'));
                    const paymentIndex = payments.findIndex(p => p.date === paymentId);
                    
                    if (paymentIndex !== -1) {
                        if (action === 'verify') {
                            payments[paymentIndex].status = 'verified';
                            
                            // Tambahkan produk ke user
                            const users = JSON.parse(localStorage.getItem('users'));
                            const userIndex = users.findIndex(u => u.username === payments[paymentIndex].username);
                            const productKey = getProductKey(payments[paymentIndex].product);
                            
                            if (userIndex !== -1 && productKey) {
                                if (!users[userIndex].products) {
                                    users[userIndex].products = [];
                                }
                                
                                if (!users[userIndex].products.includes(productKey)) {
                                    users[userIndex].products.push(productKey);
                                    localStorage.setItem('users', JSON.stringify(users));
                                    
                                    // Jika user sedang login, update currentUser
                                    if (currentUser && currentUser.username === users[userIndex].username) {
                                        currentUser = users[userIndex];
                                    }
                                    
                                    // Generate invoice
                                    generateInvoice(payments[paymentIndex]);
                                    
                                    // Hitung komisi affiliate jika ada
                                    const affiliatedBy = users[userIndex].affiliatedBy;
                                    if (affiliatedBy) {
                                        const affiliateUserIndex = users.findIndex(u => u.username === affiliatedBy);
                                        if (affiliateUserIndex !== -1) {
                                            if (!users[affiliateUserIndex].affiliateEarnings) {
                                                users[affiliateUserIndex].affiliateEarnings = [];
                                            }
                                            
                                            const commission = parseInt(payments[paymentIndex].price) * 0.1;
                                            users[affiliateUserIndex].affiliateEarnings.push({
                                                from: users[userIndex].username,
                                                product: payments[paymentIndex].product,
                                                amount: commission,
                                                date: new Date().toISOString()
                                            });
                                            
                                            localStorage.setItem('users', JSON.stringify(users));
                                        }
                                    }
                                }
                            }
                            
                            showAlert('Pembayaran berhasil diverifikasi!', 'success');
                        } else if (action === 'reject') {
                            payments[paymentIndex].status = 'rejected';
                            showAlert('Pembayaran ditolak!', 'success');
                        }
                        
                        localStorage.setItem('payments', JSON.stringify(payments));
                        loadAdminData();
                    }
                }
            });
            
            // Helper function untuk mendapatkan product key dari product name
            function getProductKey(productName) {
                switch(productName) {
                    case 'Beginner Sempoa': return 'beginner';
                    case 'Intermediate Sempoa': return 'intermediate';
                    case 'Advanced Sempoa': return 'advanced';
                    case 'Akses Link AR': return 'ar';
                    case 'Materi PDF': return 'pdf';
                    default: return null;
                }
            }
            
            // Event listener untuk tombol reset admin
            document.getElementById('confirmReset').addEventListener('click', function() {
                const adminPassword = document.getElementById('adminPassword').value;
                
                if (adminPassword === 'admin123') {
                    localStorage.removeItem('users');
                    localStorage.removeItem('payments');
                    localStorage.removeItem('trials');
                    localStorage.removeItem('affiliates');
                    localStorage.removeItem('vouchers');
                    localStorage.removeItem('links');
                    localStorage.removeItem('materials');
                    localStorage.removeItem('tests');
                    
                    // Reset ke state awal
                    localStorage.setItem('users', JSON.stringify([
                        {
                            username: 'admin',
                            password: 'admin123',
                            whatsapp: '081234567890',
                            role: 'admin',
                            registeredAt: new Date().toISOString()
                        }
                    ]));
                    localStorage.setItem('payments', JSON.stringify([]));
                    localStorage.setItem('trials', JSON.stringify([]));
                    localStorage.setItem('affiliates', JSON.stringify([]));
                    localStorage.setItem('vouchers', JSON.stringify([
                        { code: 'DISKON10', discount: 10, used: false }
                    ]));
                    localStorage.setItem('links', JSON.stringify({
                        zoom: 'https://zoom.us/j/1234567890',
                        ar: 'https://eongenesis-id.github.io/EONGENESIS/'
                    }));
                    localStorage.setItem('materials', JSON.stringify({
                        pdf: [],
                        video: []
                    }));
                    localStorage.setItem('tests', JSON.stringify({
                        pretest: [],
                        posttest: []
                    }));
                    
                    // Logout user jika sedang login
                    if (currentUser) {
                        logoutUser();
                    }
                    
                    const adminModal = bootstrap.Modal.getInstance(document.getElementById('adminModal'));
                    adminModal.hide();
                    
                    showAlert('Data berhasil direset!', 'success');
                } else {
                    showAlert('Password admin salah!', 'danger');
                }
            });
            
            // Event listener untuk print invoice
            document.getElementById('printInvoice').addEventListener('click', function() {
                window.print();
            });
            
            // Event listener untuk download invoice PDF
            document.getElementById('downloadInvoice').addEventListener('click', function() {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Ambil konten invoice
                const invoiceContent = document.getElementById('invoiceContent');
                
                // Generate nama file sesuai format: user_tanggal transaksi_jenis produk
                const paymentData = JSON.parse(localStorage.getItem('payments')).find(p => 
                    p.username === currentUser.username && p.status === 'verified'
                );
                
                if (paymentData) {
                    const userName = currentUser.username;
                    const transactionDate = new Date(paymentData.date).toLocaleDateString('id-ID').replace(/\//g, '-');
                    const productName = paymentData.product.replace(/\s+/g, '_');
                    
                    const fileName = `${userName}_${transactionDate}_${productName}.pdf`;
                    
                    // Convert HTML to PDF
                    doc.html(invoiceContent, {
                        callback: function(doc) {
                            doc.save(fileName);
                        },
                        margin: [10, 10, 10, 10],
                        autoPaging: 'text',
                        x: 0,
                        y: 0,
                        width: 190,
                        windowWidth: invoiceContent.scrollWidth
                    });
                } else {
                    showAlert('Tidak ada data pembayaran yang terverifikasi.', 'warning');
                }
            });
            
            // Cek jika admin login (username = admin)
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                const username = document.getElementById('loginUsername').value;
                
                if (username === 'admin') {
                    document.getElementById('adminResetButton').style.display = 'block';
                } else {
                    document.getElementById('adminResetButton').style.display = 'none';
                }
            });
            
            // Cek parameter referral dari URL
            const urlParams = new URLSearchParams(window.location.search);
            const refCode = urlParams.get('ref');
            if (refCode) {
                document.getElementById('affiliateCode').value = refCode;
            }
            
            // Inisialisasi
            showSection('home');
            
            // Load link zoom
            const links = JSON.parse(localStorage.getItem('links'));
            if (links && links.zoom) {
                document.getElementById('zoomLink').href = links.zoom;
            }
        });
    </script>
</body>
</html>
